# -*- coding: utf-8 -*-
"""
定款テンプレート生成モジュール
"""

def generate_teikan_text(teikan, 事業目的リスト, 発起人リスト):
    """
    定款データから定款本文を生成する
    
    Args:
        teikan: 定款データ（辞書）
        事業目的リスト: 事業目的のリスト
        発起人リスト: 発起人情報のリスト
    
    Returns:
        str: 定款本文
    """
    
    # 本店所在地の組み立て
    本店所在地 = f"{teikan['本店所在地_都道府県']}{teikan['本店所在地_市区町村']}{teikan['本店所在地_番地']}"
    if teikan.get('本店所在地_建物名'):
        本店所在地 += teikan['本店所在地_建物名']
    
    # 公告方法の文言
    公告方法_text = ""
    if teikan['公告方法'] == '官報':
        公告方法_text = "官報に掲載する方法により行う。"
    elif teikan['公告方法'] == '日刊新聞紙':
        公告方法_text = "日刊新聞紙に掲載する方法により行う。"
    elif teikan['公告方法'] == '電子公告':
        公告方法_text = "電子公告により行う。ただし、事故その他やむを得ない事由によって電子公告による公告をすることができない場合は、官報に掲載する方法により行う。"
    
    # 譲渡制限の文言
    譲渡制限_text = ""
    if teikan['譲渡制限']:
        譲渡制限_text = f"当会社の株式を譲渡により取得するには、{teikan['承認機関']}の承認を受けなければならない。"
    
    # 取締役会・監査役の文言
    機関_text = ""
    if teikan['取締役会設置']:
        機関_text += "\n\n第4章 取締役及び取締役会\n\n"
        機関_text += f"（取締役の員数）\n第10条 当会社の取締役は{teikan['取締役の人数']}名以上とする。\n\n"
        機関_text += "（取締役の選任）\n第11条 取締役は、株主総会において選任する。\n2 取締役の選任決議は、議決権を行使することができる株主の議決権の3分の1以上を有する株主が出席し、その議決権の過半数をもって行う。\n\n"
        機関_text += "（取締役の任期）\n第12条 取締役の任期は、選任後2年以内に終了する事業年度のうち最終のものに関する定時株主総会の終結の時までとする。\n\n"
        機関_text += "（代表取締役及び役付取締役）\n第13条 取締役会は、その決議によって代表取締役を選定する。\n2 取締役会は、その決議によって、取締役社長1名を選定し、必要に応じて取締役会長1名、取締役副社長、専務取締役及び常務取締役各若干名を選定することができる。\n\n"
        機関_text += "（取締役会の招集権者及び議長）\n第14条 取締役会は、法令に別段の定めがある場合を除き、取締役社長が招集し、議長となる。\n2 取締役社長に事故があるときは、取締役会においてあらかじめ定めた順序により、他の取締役が取締役会を招集し、議長となる。\n\n"
        機関_text += "（取締役会の決議方法）\n第15条 取締役会の決議は、議決に加わることができる取締役の過半数が出席し、その過半数をもって行う。\n\n"
    else:
        機関_text += "\n\n第4章 取締役及び代表取締役\n\n"
        機関_text += f"（取締役の員数）\n第10条 当会社の取締役は{teikan['取締役の人数']}名以上とする。\n\n"
        機関_text += "（取締役の選任）\n第11条 取締役は、株主総会において選任する。\n\n"
        機関_text += "（取締役の任期）\n第12条 取締役の任期は、選任後10年以内に終了する事業年度のうち最終のものに関する定時株主総会の終結の時までとする。\n\n"
        機関_text += "（代表取締役）\n第13条 当会社に取締役を1名置く場合は、その取締役が代表取締役となる。\n2 当会社に取締役を2名以上置く場合は、取締役の互選により代表取締役1名を定める。\n\n"
    
    # 監査役の文言
    if teikan['監査役設置']:
        機関_text += "\n\n第5章 監査役\n\n"
        機関_text += "（監査役の員数）\n第16条 当会社の監査役は1名以上とする。\n\n"
        機関_text += "（監査役の選任）\n第17条 監査役は、株主総会において選任する。\n\n"
        機関_text += "（監査役の任期）\n第18条 監査役の任期は、選任後4年以内に終了する事業年度のうち最終のものに関する定時株主総会の終結の時までとする。\n\n"
    
    # 事業目的の組み立て
    事業目的_text = ""
    for idx, 目的 in enumerate(事業目的リスト, start=1):
        事業目的_text += f"{idx}. {目的}\n"
    事業目的_text += f"{len(事業目的リスト) + 1}. 前各号に附帯関連する一切の業務"
    
    # 発起人の組み立て
    発起人_text = ""
    for 発起人 in 発起人リスト:
        発起人_text += f"住所 {発起人['住所']}\n"
        発起人_text += f"氏名 {発起人['氏名']}\n"
        発起人_text += f"引受株式数 {発起人['引受株式数']:,}株\n\n"
    
    # 定款本文の生成
    text = f"""
{teikan['会社名']}

定款


第1章 総則

（商号）
第1条 当会社は、{teikan['会社名']}と称する。

（目的）
第2条 当会社は、次の事業を営むことを目的とする。
{事業目的_text}

（本店の所在地）
第3条 当会社は、本店を{本店所在地}に置く。

（公告方法）
第4条 当会社の公告は、{公告方法_text}


第2章 株式

（発行可能株式総数）
第5条 当会社の発行可能株式総数は、{teikan['発行可能株式総数']:,}株とする。

（株式の譲渡制限）
第6条 {譲渡制限_text if teikan['譲渡制限'] else '当会社の株式の譲渡による取得については、制限を設けない。'}


第3章 株主総会

（招集）
第7条 当会社の定時株主総会は、毎事業年度末日の翌日から3か月以内に招集し、臨時株主総会は、必要がある場合に招集する。

（議長）
第8条 株主総会の議長は、代表取締役がこれに当たる。代表取締役に事故があるときは、あらかじめ取締役の互選で定めた順序により、他の取締役がこれに当たる。

（決議の方法）
第9条 株主総会の決議は、法令又は定款に別段の定めがある場合を除き、出席した議決権を行使することができる株主の議決権の過半数をもって行う。
2 会社法第309条第2項に定める決議は、議決権を行使することができる株主の議決権の3分の1以上を有する株主が出席し、その議決権の3分の2以上をもって行う。

{機関_text}

第{16 if teikan['監査役設置'] else 14 if teikan['取締役会設置'] else 14}章 計算

（事業年度）
第{19 if teikan['監査役設置'] else 16 if teikan['取締役会設置'] else 14}条 当会社の事業年度は、毎年{(teikan['事業年度_決算月'] % 12) + 1}月1日から{teikan['事業年度_決算月']}月末日までの年1期とする。

（剰余金の配当）
第{20 if teikan['監査役設置'] else 17 if teikan['取締役会設置'] else 15}条 剰余金の配当は、毎事業年度末日現在の株主名簿に記載又は記録された株主又は登録株式質権者に対して行う。


附則

（設立に際して出資される財産の価額）
第1条 当会社の設立に際して出資される財産の価額は、金{teikan['資本金']:,}円とする。

（最初の事業年度）
第2条 当会社の最初の事業年度は、当会社成立の日から令和○年{teikan['事業年度_決算月']}月末日までとする。

（発起人の氏名、住所及び引受株式数）
第3条 発起人の氏名、住所及び引受株式数は、次のとおりである。

{発起人_text}

（設立時取締役）
第4条 当会社の設立時取締役は、次のとおりである。
（設立後に記載）


以上、{teikan['会社名']}設立のため、この定款を作成し、発起人が次に記名押印する。

令和○年○月○日

{発起人_text}
"""
    
    return text.strip()

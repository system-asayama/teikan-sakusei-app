nohup: ignoring input
[2026-01-04 00:01:04 +0900] [46415] [INFO] Starting gunicorn 23.0.0
[2026-01-04 00:01:04 +0900] [46415] [INFO] Listening at: http://0.0.0.0:8000 (46415)
[2026-01-04 00:01:04 +0900] [46415] [INFO] Using worker: sync
[2026-01-04 00:01:04 +0900] [46416] [INFO] Booting worker with pid: 46416
[2026-01-04 00:01:04 +0900] [46417] [INFO] Booting worker with pid: 46417
[2026-01-04 00:01:04 +0900] [46418] [INFO] Booting worker with pid: 46418
[2026-01-04 00:01:04 +0900] [46419] [INFO] Booting worker with pid: 46419
✅ データベーステーブル作成完了
⚠️ PostgreSQL接続失敗 → SQLiteへフォールバック: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: No such file or directory
	Is the server running locally and accepting connections on that socket?

⚠️ SQLite にフォールバック: database/login_auth.db
✅ データベース初期化完了
{"level": "INFO", "message": "マイグレーション開始", "logger": "app.migrations"}
{"level": "ERROR", "message": "テーブル存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.TABLES\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ?]\n[parameters: ('T_従業員_店舗',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "T_従業員_店舗テーブルを作成します", "logger": "app.migrations"}
{"level": "ERROR", "message": "T_従業員_店舗テーブル作成エラー: (sqlite3.OperationalError) table \"T_従業員_店舗\" already exists\n[SQL: CREATE TABLE \"T_従業員_店舗\" (  \"id\" SERIAL PRIMARY KEY,  \"employee_id\" INTEGER NOT NULL,  \"store_id\" INTEGER NOT NULL,  \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  FOREIGN KEY (\"employee_id\") REFERENCES \"T_従業員\"(\"id\") ON DELETE CASCADE,  FOREIGN KEY (\"store_id\") REFERENCES \"T_店舗\"(\"id\") ON DELETE CASCADE)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '郵便番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.郵便番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.郵便番号 - (sqlite3.OperationalError) duplicate column name: 郵便番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"郵便番号\" VARCHAR(10) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '住所')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.住所", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.住所 - (sqlite3.OperationalError) duplicate column name: 住所\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"住所\" VARCHAR(500) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '電話番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.電話番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.電話番号 - (sqlite3.OperationalError) duplicate column name: 電話番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"電話番号\" VARCHAR(20) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'email')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.email", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.email - (sqlite3.OperationalError) duplicate column name: email\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"email\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'openai_api_key')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.openai_api_key", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.openai_api_key - (sqlite3.OperationalError) duplicate column name: openai_api_key\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"openai_api_key\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'updated_at')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.updated_at", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.updated_at - (sqlite3.OperationalError) duplicate column name: updated_at\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"updated_at\" TIMESTAMP NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'is_owner')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.is_owner", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.is_owner - (sqlite3.OperationalError) duplicate column name: is_owner\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"is_owner\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'can_manage_admins')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.can_manage_admins", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.can_manage_admins - (sqlite3.OperationalError) duplicate column name: can_manage_admins\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"can_manage_admins\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "マイグレーション完了: 追加するカラムはありませんでした", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行開始", "logger": "app.migrations"}
{"level": "INFO", "message": "DEBUG: T_管理者_店舗テーブルの既存データ数: 0", "logger": "app.migrations"}
{"level": "INFO", "message": "T_管理者テーブルから0人の店舗管理者を取得しました", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行完了", "logger": "app.migrations"}
✅ データベーステーブル作成完了
⚠️ PostgreSQL接続失敗 → SQLiteへフォールバック: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: No such file or directory
	Is the server running locally and accepting connections on that socket?

⚠️ SQLite にフォールバック: database/login_auth.db
✅ データベース初期化完了
{"level": "INFO", "message": "マイグレーション開始", "logger": "app.migrations"}
{"level": "ERROR", "message": "テーブル存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.TABLES\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ?]\n[parameters: ('T_従業員_店舗',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "T_従業員_店舗テーブルを作成します", "logger": "app.migrations"}
{"level": "ERROR", "message": "T_従業員_店舗テーブル作成エラー: (sqlite3.OperationalError) table \"T_従業員_店舗\" already exists\n[SQL: CREATE TABLE \"T_従業員_店舗\" (  \"id\" SERIAL PRIMARY KEY,  \"employee_id\" INTEGER NOT NULL,  \"store_id\" INTEGER NOT NULL,  \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  FOREIGN KEY (\"employee_id\") REFERENCES \"T_従業員\"(\"id\") ON DELETE CASCADE,  FOREIGN KEY (\"store_id\") REFERENCES \"T_店舗\"(\"id\") ON DELETE CASCADE)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '郵便番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.郵便番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.郵便番号 - (sqlite3.OperationalError) duplicate column name: 郵便番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"郵便番号\" VARCHAR(10) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '住所')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.住所", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.住所 - (sqlite3.OperationalError) duplicate column name: 住所\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"住所\" VARCHAR(500) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '電話番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.電話番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.電話番号 - (sqlite3.OperationalError) duplicate column name: 電話番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"電話番号\" VARCHAR(20) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'email')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.email", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.email - (sqlite3.OperationalError) duplicate column name: email\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"email\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'openai_api_key')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.openai_api_key", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.openai_api_key - (sqlite3.OperationalError) duplicate column name: openai_api_key\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"openai_api_key\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'updated_at')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.updated_at", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.updated_at - (sqlite3.OperationalError) duplicate column name: updated_at\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"updated_at\" TIMESTAMP NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'is_owner')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.is_owner", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.is_owner - (sqlite3.OperationalError) duplicate column name: is_owner\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"is_owner\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'can_manage_admins')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.can_manage_admins", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.can_manage_admins - (sqlite3.OperationalError) duplicate column name: can_manage_admins\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"can_manage_admins\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "マイグレーション完了: 追加するカラムはありませんでした", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行開始", "logger": "app.migrations"}
{"level": "INFO", "message": "DEBUG: T_管理者_店舗テーブルの既存データ数: 0", "logger": "app.migrations"}
{"level": "INFO", "message": "T_管理者テーブルから0人の店舗管理者を取得しました", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行完了", "logger": "app.migrations"}
✅ データベーステーブル作成完了
⚠️ PostgreSQL接続失敗 → SQLiteへフォールバック: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: No such file or directory
	Is the server running locally and accepting connections on that socket?

⚠️ SQLite にフォールバック: database/login_auth.db
✅ データベース初期化完了
{"level": "INFO", "message": "マイグレーション開始", "logger": "app.migrations"}
{"level": "ERROR", "message": "テーブル存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.TABLES\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ?]\n[parameters: ('T_従業員_店舗',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "T_従業員_店舗テーブルを作成します", "logger": "app.migrations"}
{"level": "ERROR", "message": "T_従業員_店舗テーブル作成エラー: (sqlite3.OperationalError) table \"T_従業員_店舗\" already exists\n[SQL: CREATE TABLE \"T_従業員_店舗\" (  \"id\" SERIAL PRIMARY KEY,  \"employee_id\" INTEGER NOT NULL,  \"store_id\" INTEGER NOT NULL,  \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  FOREIGN KEY (\"employee_id\") REFERENCES \"T_従業員\"(\"id\") ON DELETE CASCADE,  FOREIGN KEY (\"store_id\") REFERENCES \"T_店舗\"(\"id\") ON DELETE CASCADE)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '郵便番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.郵便番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.郵便番号 - (sqlite3.OperationalError) duplicate column name: 郵便番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"郵便番号\" VARCHAR(10) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '住所')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.住所", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.住所 - (sqlite3.OperationalError) duplicate column name: 住所\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"住所\" VARCHAR(500) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '電話番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.電話番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.電話番号 - (sqlite3.OperationalError) duplicate column name: 電話番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"電話番号\" VARCHAR(20) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'email')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.email", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.email - (sqlite3.OperationalError) duplicate column name: email\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"email\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'openai_api_key')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.openai_api_key", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.openai_api_key - (sqlite3.OperationalError) duplicate column name: openai_api_key\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"openai_api_key\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'updated_at')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.updated_at", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.updated_at - (sqlite3.OperationalError) duplicate column name: updated_at\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"updated_at\" TIMESTAMP NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'is_owner')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.is_owner", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.is_owner - (sqlite3.OperationalError) duplicate column name: is_owner\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"is_owner\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'can_manage_admins')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.can_manage_admins", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.can_manage_admins - (sqlite3.OperationalError) duplicate column name: can_manage_admins\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"can_manage_admins\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "マイグレーション完了: 追加するカラムはありませんでした", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行開始", "logger": "app.migrations"}
{"level": "INFO", "message": "DEBUG: T_管理者_店舗テーブルの既存データ数: 0", "logger": "app.migrations"}
{"level": "INFO", "message": "T_管理者テーブルから0人の店舗管理者を取得しました", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行完了", "logger": "app.migrations"}
✅ データベーステーブル作成完了
⚠️ PostgreSQL接続失敗 → SQLiteへフォールバック: connection to server on socket "/var/run/postgresql/.s.PGSQL.5432" failed: No such file or directory
	Is the server running locally and accepting connections on that socket?

⚠️ SQLite にフォールバック: database/login_auth.db
✅ データベース初期化完了
{"level": "INFO", "message": "マイグレーション開始", "logger": "app.migrations"}
{"level": "ERROR", "message": "テーブル存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.TABLES\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ?]\n[parameters: ('T_従業員_店舗',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "T_従業員_店舗テーブルを作成します", "logger": "app.migrations"}
{"level": "ERROR", "message": "T_従業員_店舗テーブル作成エラー: (sqlite3.OperationalError) table \"T_従業員_店舗\" already exists\n[SQL: CREATE TABLE \"T_従業員_店舗\" (  \"id\" SERIAL PRIMARY KEY,  \"employee_id\" INTEGER NOT NULL,  \"store_id\" INTEGER NOT NULL,  \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  FOREIGN KEY (\"employee_id\") REFERENCES \"T_従業員\"(\"id\") ON DELETE CASCADE,  FOREIGN KEY (\"store_id\") REFERENCES \"T_店舗\"(\"id\") ON DELETE CASCADE)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '郵便番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.郵便番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.郵便番号 - (sqlite3.OperationalError) duplicate column name: 郵便番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"郵便番号\" VARCHAR(10) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '住所')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.住所", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.住所 - (sqlite3.OperationalError) duplicate column name: 住所\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"住所\" VARCHAR(500) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', '電話番号')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.電話番号", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.電話番号 - (sqlite3.OperationalError) duplicate column name: 電話番号\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"電話番号\" VARCHAR(20) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'email')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.email", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.email - (sqlite3.OperationalError) duplicate column name: email\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"email\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'openai_api_key')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.openai_api_key", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.openai_api_key - (sqlite3.OperationalError) duplicate column name: openai_api_key\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"openai_api_key\" VARCHAR(255) NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_店舗', 'updated_at')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_店舗.updated_at", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_店舗.updated_at - (sqlite3.OperationalError) duplicate column name: updated_at\n[SQL: ALTER TABLE \"T_店舗\" ADD COLUMN \"updated_at\" TIMESTAMP NULL]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'is_owner')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.is_owner", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.is_owner - (sqlite3.OperationalError) duplicate column name: is_owner\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"is_owner\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム存在チェックエラー: (sqlite3.OperationalError) no such table: INFORMATION_SCHEMA.COLUMNS\n[SQL: SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = CURRENT_SCHEMA() AND TABLE_NAME = ? AND COLUMN_NAME = ?]\n[parameters: ('T_管理者_店舗', 'can_manage_admins')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "カラムを追加: T_管理者_店舗.can_manage_admins", "logger": "app.migrations"}
{"level": "ERROR", "message": "カラム追加エラー: T_管理者_店舗.can_manage_admins - (sqlite3.OperationalError) duplicate column name: can_manage_admins\n[SQL: ALTER TABLE \"T_管理者_店舗\" ADD COLUMN \"can_manage_admins\" INTEGER DEFAULT 0]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "logger": "app.migrations"}
{"level": "INFO", "message": "マイグレーション完了: 追加するカラムはありませんでした", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行開始", "logger": "app.migrations"}
{"level": "INFO", "message": "DEBUG: T_管理者_店舗テーブルの既存データ数: 0", "logger": "app.migrations"}
{"level": "INFO", "message": "T_管理者テーブルから0人の店舗管理者を取得しました", "logger": "app.migrations"}
{"level": "INFO", "message": "店舗管理者データ移行完了", "logger": "app.migrations"}
